<!DOCTYPE html>
<html>
<head>
  <title>Admin â€“ Publish Post</title>
</head>
<body>

<h2>Admin Login</h2>

<div id="loginBox">
  <input type="email" id="email" placeholder="Admin Email"><br><br>
  <input type="password" id="password" placeholder="Password"><br><br>
  <button onclick="login()">Login</button>
</div>

<div id="adminBox" style="display:none;">
  <h2>Create Post</h2>

  <input type="text" id="title" placeholder="Post Title"><br><br>
  <textarea id="content" placeholder="Post Content"></textarea><br><br>
  <button onclick="publishPost()">Publish</button>
  <br><br>
  <button onclick="logout()">Logout</button>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Auth check
onAuthStateChanged(auth, (user) => {
  if (user) {
    document.getElementById("loginBox").style.display = "none";
    document.getElementById("adminBox").style.display = "block";
  } else {
    document.getElementById("loginBox").style.display = "block";
    document.getElementById("adminBox").style.display = "none";
  }
});

// Login
window.login = function () {
  signInWithEmailAndPassword(
    auth,
    email.value,
    password.value
  ).catch(alert);
};

// Publish
window.publishPost = async function () {
  await addDoc(collection(db, "posts"), {
    title: title.value,
    content: content.value,
    createdAt: serverTimestamp()
  });
  alert("Post Published");
  title.value = "";
  content.value = "";
};

// Logout
window.logout = function () {
  signOut(auth);
};
</script>

</body>
</html>
